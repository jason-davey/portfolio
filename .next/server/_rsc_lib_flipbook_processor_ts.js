"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "_rsc_lib_flipbook_processor_ts";
exports.ids = ["_rsc_lib_flipbook_processor_ts"];
exports.modules = {

/***/ "(rsc)/./lib/flipbook/db.ts":
/*!****************************!*\
  !*** ./lib/flipbook/db.ts ***!
  \****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createDocument: () => (/* binding */ createDocument),\n/* harmony export */   deleteDocument: () => (/* binding */ deleteDocument),\n/* harmony export */   generateSlug: () => (/* binding */ generateSlug),\n/* harmony export */   generateUniqueSlug: () => (/* binding */ generateUniqueSlug),\n/* harmony export */   getDocumentById: () => (/* binding */ getDocumentById),\n/* harmony export */   getDocumentBySlug: () => (/* binding */ getDocumentBySlug),\n/* harmony export */   insertPages: () => (/* binding */ insertPages),\n/* harmony export */   isSlugAvailable: () => (/* binding */ isSlugAvailable),\n/* harmony export */   listDocuments: () => (/* binding */ listDocuments),\n/* harmony export */   markDocumentError: () => (/* binding */ markDocumentError),\n/* harmony export */   publishDocument: () => (/* binding */ publishDocument),\n/* harmony export */   supabase: () => (/* binding */ supabase),\n/* harmony export */   updateDocumentProgress: () => (/* binding */ updateDocumentProgress)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/**\n * Database operations for Flipbook system\n * Using Supabase client for PostgreSQL operations\n */ \nconst supabaseUrl = \"https://xdzaqafffixglhjfwqsy.supabase.co\";\nconst supabaseKey = process.env.SUPABASE_SERVICE_ROLE_KEY// Use service role for admin operations\n;\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseKey);\n/**\n * Create a new document record\n */ async function createDocument(data) {\n    const { data: document, error } = await supabase.from(\"flipbook_documents\").insert([\n        {\n            title: data.title,\n            slug: data.slug,\n            description: data.description || null,\n            original_file_url: data.original_file_url,\n            file_size: data.file_size || null,\n            project_id: data.project_id || null,\n            status: \"processing\",\n            processing_progress: 0\n        }\n    ]).select().single();\n    if (error) throw new Error(`Failed to create document: ${error.message}`);\n    return document;\n}\n/**\n * Update document processing progress\n */ async function updateDocumentProgress(documentId, progress) {\n    const { error } = await supabase.from(\"flipbook_documents\").update({\n        processing_progress: progress\n    }).eq(\"id\", documentId);\n    if (error) throw new Error(`Failed to update progress: ${error.message}`);\n}\n/**\n * Mark document as completed (published)\n */ async function publishDocument(documentId, totalPages, thumbnailUrl) {\n    const { error } = await supabase.from(\"flipbook_documents\").update({\n        status: \"published\",\n        processing_progress: 100,\n        total_pages: totalPages,\n        thumbnail_url: thumbnailUrl,\n        published_at: new Date().toISOString()\n    }).eq(\"id\", documentId);\n    if (error) throw new Error(`Failed to publish document: ${error.message}`);\n}\n/**\n * Mark document as failed\n */ async function markDocumentError(documentId, errorMessage) {\n    const { error } = await supabase.from(\"flipbook_documents\").update({\n        status: \"error\",\n        error_message: errorMessage\n    }).eq(\"id\", documentId);\n    if (error) throw new Error(`Failed to mark error: ${error.message}`);\n}\n/**\n * Insert page records for a document\n */ async function insertPages(documentId, pages) {\n    const pageData = pages.map((page)=>({\n            document_id: documentId,\n            ...page\n        }));\n    const { error } = await supabase.from(\"flipbook_pages\").insert(pageData);\n    if (error) throw new Error(`Failed to insert pages: ${error.message}`);\n}\n/**\n * Get a single document with its pages by slug\n */ async function getDocumentBySlug(slug) {\n    const { data: document, error: docError } = await supabase.from(\"flipbook_documents\").select(\"*\").eq(\"slug\", slug).eq(\"status\", \"published\").single();\n    if (docError || !document) return null;\n    const { data: pages, error: pagesError } = await supabase.from(\"flipbook_pages\").select(\"*\").eq(\"document_id\", document.id).order(\"page_number\", {\n        ascending: true\n    });\n    if (pagesError) throw new Error(`Failed to fetch pages: ${pagesError.message}`);\n    return {\n        ...document,\n        pages: pages || []\n    };\n}\n/**\n * Get a single document by ID (admin access)\n */ async function getDocumentById(id) {\n    const { data: document, error: docError } = await supabase.from(\"flipbook_documents\").select(\"*\").eq(\"id\", id).single();\n    if (docError || !document) return null;\n    const { data: pages, error: pagesError } = await supabase.from(\"flipbook_pages\").select(\"*\").eq(\"document_id\", document.id).order(\"page_number\", {\n        ascending: true\n    });\n    if (pagesError) return {\n        ...document,\n        pages: []\n    };\n    return {\n        ...document,\n        pages: pages || []\n    };\n}\n/**\n * List all documents (admin)\n */ async function listDocuments(options) {\n    let query = supabase.from(\"flipbook_documents\").select(\"*\").order(\"created_at\", {\n        ascending: false\n    });\n    if (options?.status) {\n        query = query.eq(\"status\", options.status);\n    }\n    if (options?.limit) {\n        query = query.limit(options.limit);\n    }\n    if (options?.offset) {\n        query = query.range(options.offset, options.offset + (options.limit || 10) - 1);\n    }\n    const { data, error } = await query;\n    if (error) throw new Error(`Failed to list documents: ${error.message}`);\n    return data || [];\n}\n/**\n * Delete a document and all its pages\n */ async function deleteDocument(id) {\n    // Pages will be deleted automatically due to CASCADE\n    const { error } = await supabase.from(\"flipbook_documents\").delete().eq(\"id\", id);\n    if (error) throw new Error(`Failed to delete document: ${error.message}`);\n}\n/**\n * Generate a unique slug from title\n */ function generateSlug(title) {\n    return title.toLowerCase().replace(/[^a-z0-9]+/g, \"-\").replace(/(^-|-$)/g, \"\");\n}\n/**\n * Check if slug is available\n */ async function isSlugAvailable(slug, excludeId) {\n    let query = supabase.from(\"flipbook_documents\").select(\"id\").eq(\"slug\", slug);\n    if (excludeId) {\n        query = query.neq(\"id\", excludeId);\n    }\n    const { data, error } = await query;\n    if (error) return false;\n    return !data || data.length === 0;\n}\n/**\n * Generate unique slug by adding number suffix if needed\n */ async function generateUniqueSlug(title, excludeId) {\n    let slug = generateSlug(title);\n    let counter = 1;\n    while(!await isSlugAvailable(slug, excludeId)){\n        slug = `${generateSlug(title)}-${counter}`;\n        counter++;\n    }\n    return slug;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDWEMsT0FBTyxDQUFDLGVBQWUsS0FDdkJBLE9BQU8sQ0FBQyxZQUFZO0FBQ3pCO0FBRUE7O0NBRUMsR0FDTSxlQUFlQyxnQkFBZ0JuRCxJQUFZLEVBQUVvRCxTQUFrQjtJQUNwRSxJQUFJVixRQUFRbEQsU0FDVEssSUFBSSxDQUFDLHNCQUNMVSxNQUFNLENBQUMsTUFDUFEsRUFBRSxDQUFDLFFBQVFmO0lBRWQsSUFBSW9ELFdBQVc7UUFDYlYsUUFBUUEsTUFBTVcsR0FBRyxDQUFDLE1BQU1EO0lBQzFCO0lBRUEsTUFBTSxFQUFFMUQsSUFBSSxFQUFFRSxLQUFLLEVBQUUsR0FBRyxNQUFNOEM7SUFFOUIsSUFBSTlDLE9BQU8sT0FBTztJQUNsQixPQUFPLENBQUNGLFFBQVFBLEtBQUs0RCxNQUFNLEtBQUs7QUFDbEM7QUFFQTs7Q0FFQyxHQUNNLGVBQWVDLG1CQUFtQnhELEtBQWEsRUFBRXFELFNBQWtCO0lBQ3hFLElBQUlwRCxPQUFPZ0QsYUFBYWpEO0lBQ3hCLElBQUl5RCxVQUFVO0lBRWQsTUFBTyxDQUFFLE1BQU1MLGdCQUFnQm5ELE1BQU1vRCxXQUFhO1FBQ2hEcEQsT0FBTyxDQUFDLEVBQUVnRCxhQUFhakQsT0FBTyxDQUFDLEVBQUV5RCxRQUFRLENBQUM7UUFDMUNBO0lBQ0Y7SUFFQSxPQUFPeEQ7QUFDVCIsInNvdXJjZXMiOlsid2VicGFjazovL3BvcnRmb2xpby1hcHAvLi9saWIvZmxpcGJvb2svZGIudHM/NzI5ZCJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIERhdGFiYXNlIG9wZXJhdGlvbnMgZm9yIEZsaXBib29rIHN5c3RlbVxuICogVXNpbmcgU3VwYWJhc2UgY2xpZW50IGZvciBQb3N0Z3JlU1FMIG9wZXJhdGlvbnNcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIVxuY29uc3Qgc3VwYWJhc2VLZXkgPSBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZISAvLyBVc2Ugc2VydmljZSByb2xlIGZvciBhZG1pbiBvcGVyYXRpb25zXG5cbmV4cG9ydCBjb25zdCBzdXBhYmFzZSA9IGNyZWF0ZUNsaWVudChzdXBhYmFzZVVybCwgc3VwYWJhc2VLZXkpXG5cbmV4cG9ydCBpbnRlcmZhY2UgRmxpcGJvb2tEb2N1bWVudCB7XG4gIGlkOiBzdHJpbmdcbiAgdGl0bGU6IHN0cmluZ1xuICBzbHVnOiBzdHJpbmdcbiAgZGVzY3JpcHRpb246IHN0cmluZyB8IG51bGxcbiAgb3JpZ2luYWxfZmlsZV91cmw6IHN0cmluZ1xuICB0aHVtYm5haWxfdXJsOiBzdHJpbmcgfCBudWxsXG4gIHRvdGFsX3BhZ2VzOiBudW1iZXJcbiAgZmlsZV9zaXplOiBudW1iZXIgfCBudWxsXG4gIHN0YXR1czogJ3Byb2Nlc3NpbmcnIHwgJ3B1Ymxpc2hlZCcgfCAnZHJhZnQnIHwgJ2Vycm9yJ1xuICBwcm9jZXNzaW5nX3Byb2dyZXNzOiBudW1iZXJcbiAgZXJyb3JfbWVzc2FnZTogc3RyaW5nIHwgbnVsbFxuICBwcm9qZWN0X2lkOiBzdHJpbmcgfCBudWxsXG4gIGNyZWF0ZWRfYXQ6IHN0cmluZ1xuICB1cGRhdGVkX2F0OiBzdHJpbmdcbiAgcHVibGlzaGVkX2F0OiBzdHJpbmcgfCBudWxsXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgRmxpcGJvb2tQYWdlIHtcbiAgaWQ6IHN0cmluZ1xuICBkb2N1bWVudF9pZDogc3RyaW5nXG4gIHBhZ2VfbnVtYmVyOiBudW1iZXJcbiAgaW1hZ2VfdXJsOiBzdHJpbmdcbiAgd2lkdGg6IG51bWJlclxuICBoZWlnaHQ6IG51bWJlclxuICBleHRyYWN0ZWRfdGV4dDogc3RyaW5nIHwgbnVsbFxuICBjcmVhdGVkX2F0OiBzdHJpbmdcbn1cblxuZXhwb3J0IGludGVyZmFjZSBEb2N1bWVudFdpdGhQYWdlcyBleHRlbmRzIEZsaXBib29rRG9jdW1lbnQge1xuICBwYWdlczogRmxpcGJvb2tQYWdlW11cbn1cblxuLyoqXG4gKiBDcmVhdGUgYSBuZXcgZG9jdW1lbnQgcmVjb3JkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjcmVhdGVEb2N1bWVudChkYXRhOiB7XG4gIHRpdGxlOiBzdHJpbmdcbiAgc2x1Zzogc3RyaW5nXG4gIGRlc2NyaXB0aW9uPzogc3RyaW5nXG4gIG9yaWdpbmFsX2ZpbGVfdXJsOiBzdHJpbmdcbiAgZmlsZV9zaXplPzogbnVtYmVyXG4gIHByb2plY3RfaWQ/OiBzdHJpbmdcbn0pOiBQcm9taXNlPEZsaXBib29rRG9jdW1lbnQ+IHtcbiAgY29uc3QgeyBkYXRhOiBkb2N1bWVudCwgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2ZsaXBib29rX2RvY3VtZW50cycpXG4gICAgLmluc2VydChbe1xuICAgICAgdGl0bGU6IGRhdGEudGl0bGUsXG4gICAgICBzbHVnOiBkYXRhLnNsdWcsXG4gICAgICBkZXNjcmlwdGlvbjogZGF0YS5kZXNjcmlwdGlvbiB8fCBudWxsLFxuICAgICAgb3JpZ2luYWxfZmlsZV91cmw6IGRhdGEub3JpZ2luYWxfZmlsZV91cmwsXG4gICAgICBmaWxlX3NpemU6IGRhdGEuZmlsZV9zaXplIHx8IG51bGwsXG4gICAgICBwcm9qZWN0X2lkOiBkYXRhLnByb2plY3RfaWQgfHwgbnVsbCxcbiAgICAgIHN0YXR1czogJ3Byb2Nlc3NpbmcnLFxuICAgICAgcHJvY2Vzc2luZ19wcm9ncmVzczogMCxcbiAgICB9XSlcbiAgICAuc2VsZWN0KClcbiAgICAuc2luZ2xlKClcblxuICBpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGNyZWF0ZSBkb2N1bWVudDogJHtlcnJvci5tZXNzYWdlfWApXG4gIHJldHVybiBkb2N1bWVudFxufVxuXG4vKipcbiAqIFVwZGF0ZSBkb2N1bWVudCBwcm9jZXNzaW5nIHByb2dyZXNzXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGRhdGVEb2N1bWVudFByb2dyZXNzKFxuICBkb2N1bWVudElkOiBzdHJpbmcsXG4gIHByb2dyZXNzOiBudW1iZXJcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdmbGlwYm9va19kb2N1bWVudHMnKVxuICAgIC51cGRhdGUoeyBwcm9jZXNzaW5nX3Byb2dyZXNzOiBwcm9ncmVzcyB9KVxuICAgIC5lcSgnaWQnLCBkb2N1bWVudElkKVxuXG4gIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gdXBkYXRlIHByb2dyZXNzOiAke2Vycm9yLm1lc3NhZ2V9YClcbn1cblxuLyoqXG4gKiBNYXJrIGRvY3VtZW50IGFzIGNvbXBsZXRlZCAocHVibGlzaGVkKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHVibGlzaERvY3VtZW50KFxuICBkb2N1bWVudElkOiBzdHJpbmcsXG4gIHRvdGFsUGFnZXM6IG51bWJlcixcbiAgdGh1bWJuYWlsVXJsOiBzdHJpbmdcbik6IFByb21pc2U8dm9pZD4ge1xuICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdmbGlwYm9va19kb2N1bWVudHMnKVxuICAgIC51cGRhdGUoe1xuICAgICAgc3RhdHVzOiAncHVibGlzaGVkJyxcbiAgICAgIHByb2Nlc3NpbmdfcHJvZ3Jlc3M6IDEwMCxcbiAgICAgIHRvdGFsX3BhZ2VzOiB0b3RhbFBhZ2VzLFxuICAgICAgdGh1bWJuYWlsX3VybDogdGh1bWJuYWlsVXJsLFxuICAgICAgcHVibGlzaGVkX2F0OiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgfSlcbiAgICAuZXEoJ2lkJywgZG9jdW1lbnRJZClcblxuICBpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHB1Ymxpc2ggZG9jdW1lbnQ6ICR7ZXJyb3IubWVzc2FnZX1gKVxufVxuXG4vKipcbiAqIE1hcmsgZG9jdW1lbnQgYXMgZmFpbGVkXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBtYXJrRG9jdW1lbnRFcnJvcihcbiAgZG9jdW1lbnRJZDogc3RyaW5nLFxuICBlcnJvck1lc3NhZ2U6IHN0cmluZ1xuKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2ZsaXBib29rX2RvY3VtZW50cycpXG4gICAgLnVwZGF0ZSh7XG4gICAgICBzdGF0dXM6ICdlcnJvcicsXG4gICAgICBlcnJvcl9tZXNzYWdlOiBlcnJvck1lc3NhZ2UsXG4gICAgfSlcbiAgICAuZXEoJ2lkJywgZG9jdW1lbnRJZClcblxuICBpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIG1hcmsgZXJyb3I6ICR7ZXJyb3IubWVzc2FnZX1gKVxufVxuXG4vKipcbiAqIEluc2VydCBwYWdlIHJlY29yZHMgZm9yIGEgZG9jdW1lbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydFBhZ2VzKFxuICBkb2N1bWVudElkOiBzdHJpbmcsXG4gIHBhZ2VzOiBBcnJheTx7XG4gICAgcGFnZV9udW1iZXI6IG51bWJlclxuICAgIGltYWdlX3VybDogc3RyaW5nXG4gICAgd2lkdGg6IG51bWJlclxuICAgIGhlaWdodDogbnVtYmVyXG4gIH0+XG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgY29uc3QgcGFnZURhdGEgPSBwYWdlcy5tYXAocGFnZSA9PiAoe1xuICAgIGRvY3VtZW50X2lkOiBkb2N1bWVudElkLFxuICAgIC4uLnBhZ2UsXG4gIH0pKVxuXG4gIGNvbnN0IHsgZXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2ZsaXBib29rX3BhZ2VzJylcbiAgICAuaW5zZXJ0KHBhZ2VEYXRhKVxuXG4gIGlmIChlcnJvcikgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gaW5zZXJ0IHBhZ2VzOiAke2Vycm9yLm1lc3NhZ2V9YClcbn1cblxuLyoqXG4gKiBHZXQgYSBzaW5nbGUgZG9jdW1lbnQgd2l0aCBpdHMgcGFnZXMgYnkgc2x1Z1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RG9jdW1lbnRCeVNsdWcoc2x1Zzogc3RyaW5nKTogUHJvbWlzZTxEb2N1bWVudFdpdGhQYWdlcyB8IG51bGw+IHtcbiAgY29uc3QgeyBkYXRhOiBkb2N1bWVudCwgZXJyb3I6IGRvY0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdmbGlwYm9va19kb2N1bWVudHMnKVxuICAgIC5zZWxlY3QoJyonKVxuICAgIC5lcSgnc2x1ZycsIHNsdWcpXG4gICAgLmVxKCdzdGF0dXMnLCAncHVibGlzaGVkJylcbiAgICAuc2luZ2xlKClcblxuICBpZiAoZG9jRXJyb3IgfHwgIWRvY3VtZW50KSByZXR1cm4gbnVsbFxuXG4gIGNvbnN0IHsgZGF0YTogcGFnZXMsIGVycm9yOiBwYWdlc0Vycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdmbGlwYm9va19wYWdlcycpXG4gICAgLnNlbGVjdCgnKicpXG4gICAgLmVxKCdkb2N1bWVudF9pZCcsIGRvY3VtZW50LmlkKVxuICAgIC5vcmRlcigncGFnZV9udW1iZXInLCB7IGFzY2VuZGluZzogdHJ1ZSB9KVxuXG4gIGlmIChwYWdlc0Vycm9yKSB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byBmZXRjaCBwYWdlczogJHtwYWdlc0Vycm9yLm1lc3NhZ2V9YClcblxuICByZXR1cm4ge1xuICAgIC4uLmRvY3VtZW50LFxuICAgIHBhZ2VzOiBwYWdlcyB8fCBbXSxcbiAgfVxufVxuXG4vKipcbiAqIEdldCBhIHNpbmdsZSBkb2N1bWVudCBieSBJRCAoYWRtaW4gYWNjZXNzKVxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0RG9jdW1lbnRCeUlkKGlkOiBzdHJpbmcpOiBQcm9taXNlPERvY3VtZW50V2l0aFBhZ2VzIHwgbnVsbD4ge1xuICBjb25zdCB7IGRhdGE6IGRvY3VtZW50LCBlcnJvcjogZG9jRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2ZsaXBib29rX2RvY3VtZW50cycpXG4gICAgLnNlbGVjdCgnKicpXG4gICAgLmVxKCdpZCcsIGlkKVxuICAgIC5zaW5nbGUoKVxuXG4gIGlmIChkb2NFcnJvciB8fCAhZG9jdW1lbnQpIHJldHVybiBudWxsXG5cbiAgY29uc3QgeyBkYXRhOiBwYWdlcywgZXJyb3I6IHBhZ2VzRXJyb3IgfSA9IGF3YWl0IHN1cGFiYXNlXG4gICAgLmZyb20oJ2ZsaXBib29rX3BhZ2VzJylcbiAgICAuc2VsZWN0KCcqJylcbiAgICAuZXEoJ2RvY3VtZW50X2lkJywgZG9jdW1lbnQuaWQpXG4gICAgLm9yZGVyKCdwYWdlX251bWJlcicsIHsgYXNjZW5kaW5nOiB0cnVlIH0pXG5cbiAgaWYgKHBhZ2VzRXJyb3IpIHJldHVybiB7IC4uLmRvY3VtZW50LCBwYWdlczogW10gfVxuXG4gIHJldHVybiB7XG4gICAgLi4uZG9jdW1lbnQsXG4gICAgcGFnZXM6IHBhZ2VzIHx8IFtdLFxuICB9XG59XG5cbi8qKlxuICogTGlzdCBhbGwgZG9jdW1lbnRzIChhZG1pbilcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGxpc3REb2N1bWVudHMob3B0aW9ucz86IHtcbiAgc3RhdHVzPzogRmxpcGJvb2tEb2N1bWVudFsnc3RhdHVzJ11cbiAgbGltaXQ/OiBudW1iZXJcbiAgb2Zmc2V0PzogbnVtYmVyXG59KTogUHJvbWlzZTxGbGlwYm9va0RvY3VtZW50W10+IHtcbiAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAuZnJvbSgnZmxpcGJvb2tfZG9jdW1lbnRzJylcbiAgICAuc2VsZWN0KCcqJylcbiAgICAub3JkZXIoJ2NyZWF0ZWRfYXQnLCB7IGFzY2VuZGluZzogZmFsc2UgfSlcblxuICBpZiAob3B0aW9ucz8uc3RhdHVzKSB7XG4gICAgcXVlcnkgPSBxdWVyeS5lcSgnc3RhdHVzJywgb3B0aW9ucy5zdGF0dXMpXG4gIH1cblxuICBpZiAob3B0aW9ucz8ubGltaXQpIHtcbiAgICBxdWVyeSA9IHF1ZXJ5LmxpbWl0KG9wdGlvbnMubGltaXQpXG4gIH1cblxuICBpZiAob3B0aW9ucz8ub2Zmc2V0KSB7XG4gICAgcXVlcnkgPSBxdWVyeS5yYW5nZShvcHRpb25zLm9mZnNldCwgb3B0aW9ucy5vZmZzZXQgKyAob3B0aW9ucy5saW1pdCB8fCAxMCkgLSAxKVxuICB9XG5cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnlcblxuICBpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGxpc3QgZG9jdW1lbnRzOiAke2Vycm9yLm1lc3NhZ2V9YClcbiAgcmV0dXJuIGRhdGEgfHwgW11cbn1cblxuLyoqXG4gKiBEZWxldGUgYSBkb2N1bWVudCBhbmQgYWxsIGl0cyBwYWdlc1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZGVsZXRlRG9jdW1lbnQoaWQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAvLyBQYWdlcyB3aWxsIGJlIGRlbGV0ZWQgYXV0b21hdGljYWxseSBkdWUgdG8gQ0FTQ0FERVxuICBjb25zdCB7IGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZVxuICAgIC5mcm9tKCdmbGlwYm9va19kb2N1bWVudHMnKVxuICAgIC5kZWxldGUoKVxuICAgIC5lcSgnaWQnLCBpZClcblxuICBpZiAoZXJyb3IpIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIGRlbGV0ZSBkb2N1bWVudDogJHtlcnJvci5tZXNzYWdlfWApXG59XG5cbi8qKlxuICogR2VuZXJhdGUgYSB1bmlxdWUgc2x1ZyBmcm9tIHRpdGxlXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBnZW5lcmF0ZVNsdWcodGl0bGU6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiB0aXRsZVxuICAgIC50b0xvd2VyQ2FzZSgpXG4gICAgLnJlcGxhY2UoL1teYS16MC05XSsvZywgJy0nKVxuICAgIC5yZXBsYWNlKC8oXi18LSQpL2csICcnKVxufVxuXG4vKipcbiAqIENoZWNrIGlmIHNsdWcgaXMgYXZhaWxhYmxlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpc1NsdWdBdmFpbGFibGUoc2x1Zzogc3RyaW5nLCBleGNsdWRlSWQ/OiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgbGV0IHF1ZXJ5ID0gc3VwYWJhc2VcbiAgICAuZnJvbSgnZmxpcGJvb2tfZG9jdW1lbnRzJylcbiAgICAuc2VsZWN0KCdpZCcpXG4gICAgLmVxKCdzbHVnJywgc2x1ZylcblxuICBpZiAoZXhjbHVkZUlkKSB7XG4gICAgcXVlcnkgPSBxdWVyeS5uZXEoJ2lkJywgZXhjbHVkZUlkKVxuICB9XG5cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgcXVlcnlcblxuICBpZiAoZXJyb3IpIHJldHVybiBmYWxzZVxuICByZXR1cm4gIWRhdGEgfHwgZGF0YS5sZW5ndGggPT09IDBcbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSB1bmlxdWUgc2x1ZyBieSBhZGRpbmcgbnVtYmVyIHN1ZmZpeCBpZiBuZWVkZWRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlVW5pcXVlU2x1Zyh0aXRsZTogc3RyaW5nLCBleGNsdWRlSWQ/OiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICBsZXQgc2x1ZyA9IGdlbmVyYXRlU2x1Zyh0aXRsZSlcbiAgbGV0IGNvdW50ZXIgPSAxXG5cbiAgd2hpbGUgKCEoYXdhaXQgaXNTbHVnQXZhaWxhYmxlKHNsdWcsIGV4Y2x1ZGVJZCkpKSB7XG4gICAgc2x1ZyA9IGAke2dlbmVyYXRlU2x1Zyh0aXRsZSl9LSR7Y291bnRlcn1gXG4gICAgY291bnRlcisrXG4gIH1cblxuICByZXR1cm4gc2x1Z1xufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlS2V5IiwiU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSIsInN1cGFiYXNlIiwiY3JlYXRlRG9jdW1lbnQiLCJkYXRhIiwiZG9jdW1lbnQiLCJlcnJvciIsImZyb20iLCJpbnNlcnQiLCJ0aXRsZSIsInNsdWciLCJkZXNjcmlwdGlvbiIsIm9yaWdpbmFsX2ZpbGVfdXJsIiwiZmlsZV9zaXplIiwicHJvamVjdF9pZCIsInN0YXR1cyIsInByb2Nlc3NpbmdfcHJvZ3Jlc3MiLCJzZWxlY3QiLCJzaW5nbGUiLCJFcnJvciIsIm1lc3NhZ2UiLCJ1cGRhdGVEb2N1bWVudFByb2dyZXNzIiwiZG9jdW1lbnRJZCIsInByb2dyZXNzIiwidXBkYXRlIiwiZXEiLCJwdWJsaXNoRG9jdW1lbnQiLCJ0b3RhbFBhZ2VzIiwidGh1bWJuYWlsVXJsIiwidG90YWxfcGFnZXMiLCJ0aHVtYm5haWxfdXJsIiwicHVibGlzaGVkX2F0IiwiRGF0ZSIsInRvSVNPU3RyaW5nIiwibWFya0RvY3VtZW50RXJyb3IiLCJlcnJvck1lc3NhZ2UiLCJlcnJvcl9tZXNzYWdlIiwiaW5zZXJ0UGFnZXMiLCJwYWdlcyIsInBhZ2VEYXRhIiwibWFwIiwicGFnZSIsImRvY3VtZW50X2lkIiwiZ2V0RG9jdW1lbnRCeVNsdWciLCJkb2NFcnJvciIsInBhZ2VzRXJyb3IiLCJpZCIsIm9yZGVyIiwiYXNjZW5kaW5nIiwiZ2V0RG9jdW1lbnRCeUlkIiwibGlzdERvY3VtZW50cyIsIm9wdGlvbnMiLCJxdWVyeSIsImxpbWl0Iiwib2Zmc2V0IiwicmFuZ2UiLCJkZWxldGVEb2N1bWVudCIsImRlbGV0ZSIsImdlbmVyYXRlU2x1ZyIsInRvTG93ZXJDYXNlIiwicmVwbGFjZSIsImlzU2x1Z0F2YWlsYWJsZSIsImV4Y2x1ZGVJZCIsIm5lcSIsImxlbmd0aCIsImdlbmVyYXRlVW5pcXVlU2x1ZyIsImNvdW50ZXIiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./lib/flipbook/db.ts\n");

/***/ }),

/***/ "(rsc)/./lib/flipbook/processor.ts":
/*!***********************************!*\
  !*** ./lib/flipbook/processor.ts ***!
  \***********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   estimateProcessingTime: () => (/* binding */ estimateProcessingTime),\n/* harmony export */   generateThumbnail: () => (/* binding */ generateThumbnail),\n/* harmony export */   getPdfPageCount: () => (/* binding */ getPdfPageCount),\n/* harmony export */   processDocument: () => (/* binding */ processDocument),\n/* harmony export */   processPdfToImages: () => (/* binding */ processPdfToImages)\n/* harmony export */ });\n/* harmony import */ var pdf_lib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! pdf-lib */ \"(rsc)/./node_modules/pdf-lib/es/index.js\");\n/* harmony import */ var _storage_supabase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./storage-supabase */ \"(rsc)/./lib/flipbook/storage-supabase.ts\");\n/* harmony import */ var _db__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./db */ \"(rsc)/./lib/flipbook/db.ts\");\n/**\n * PDF Processing for Flipbook system\n * Converts PDF pages to images using pure JavaScript (no native dependencies)\n *\n * Uses pdf-lib for PDF manipulation - works on Vercel serverless functions\n */ \n\n\n/**\n * Process a PDF file and convert pages to images\n * Note: This converts PDF pages to PNG using pdf-lib's built-in rendering\n */ async function processPdfToImages(pdfUrl, documentId, options = {}) {\n    const { quality = 85, maxWidth = 1600 } = options;\n    try {\n        // Fetch the PDF\n        const response = await fetch(pdfUrl);\n        const pdfBytes = await response.arrayBuffer();\n        // Load PDF document\n        const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_0__.PDFDocument.load(pdfBytes);\n        const totalPages = pdfDoc.getPageCount();\n        const pages = [];\n        console.log(`Processing ${totalPages} pages from PDF`);\n        // Process each page\n        for(let pageIndex = 0; pageIndex < totalPages; pageIndex++){\n            const pageNum = pageIndex + 1;\n            // Create a new PDF with just this page\n            const singlePagePdf = await pdf_lib__WEBPACK_IMPORTED_MODULE_0__.PDFDocument.create();\n            const [copiedPage] = await singlePagePdf.copyPages(pdfDoc, [\n                pageIndex\n            ]);\n            singlePagePdf.addPage(copiedPage);\n            // Get page dimensions\n            const page = pdfDoc.getPage(pageIndex);\n            let { width, height } = page.getSize();\n            // Scale down if too wide\n            if (width > maxWidth) {\n                const scale = maxWidth / width;\n                width = maxWidth;\n                height = height * scale;\n            }\n            // Save as PDF bytes (we'll convert to image on the client side for display)\n            const pdfPageBytes = await singlePagePdf.save();\n            const buffer = Buffer.from(pdfPageBytes);\n            // Upload to storage\n            const { url } = await (0,_storage_supabase__WEBPACK_IMPORTED_MODULE_1__.uploadPageImage)(buffer, documentId, pageNum);\n            pages.push({\n                page_number: pageNum,\n                image_url: url,\n                width: Math.round(width),\n                height: Math.round(height)\n            });\n            // Update progress\n            const progress = Math.floor(pageNum / totalPages * 90) // Reserve 10% for finalization\n            ;\n            await (0,_db__WEBPACK_IMPORTED_MODULE_2__.updateDocumentProgress)(documentId, progress);\n            console.log(`Processed page ${pageNum}/${totalPages}`);\n        }\n        return pages;\n    } catch (error) {\n        console.error(\"PDF processing error:\", error);\n        throw new Error(`Failed to process PDF: ${error instanceof Error ? error.message : \"Unknown error\"}`);\n    }\n}\n/**\n * Generate thumbnail from first page\n * For now, we'll use the first page PDF as the thumbnail\n */ async function generateThumbnail(firstPageUrl, documentId) {\n    try {\n        // Fetch first page\n        const response = await fetch(firstPageUrl);\n        const buffer = Buffer.from(await response.arrayBuffer());\n        // For now, just use the first page PDF as thumbnail\n        // The client will render it at thumbnail size\n        const thumbnailUrl = await (0,_storage_supabase__WEBPACK_IMPORTED_MODULE_1__.uploadThumbnail)(buffer, documentId);\n        return thumbnailUrl;\n    } catch (error) {\n        console.error(\"Thumbnail generation error:\", error);\n        throw new Error(\"Failed to generate thumbnail\");\n    }\n}\n/**\n * Complete end-to-end processing pipeline\n */ async function processDocument(pdfUrl, documentId, options) {\n    try {\n        // Step 1: Convert PDF to page PDFs\n        console.log(`Starting processing for document ${documentId}`);\n        const pages = await processPdfToImages(pdfUrl, documentId, options);\n        // Step 2: Insert page records into database\n        await (0,_db__WEBPACK_IMPORTED_MODULE_2__.insertPages)(documentId, pages);\n        await (0,_db__WEBPACK_IMPORTED_MODULE_2__.updateDocumentProgress)(documentId, 95);\n        // Step 3: Generate thumbnail\n        const thumbnailUrl = await generateThumbnail(pages[0].image_url, documentId);\n        await (0,_db__WEBPACK_IMPORTED_MODULE_2__.updateDocumentProgress)(documentId, 98);\n        // Step 4: Mark as published\n        await (0,_db__WEBPACK_IMPORTED_MODULE_2__.publishDocument)(documentId, pages.length, thumbnailUrl);\n        console.log(`Successfully processed document ${documentId} with ${pages.length} pages`);\n    } catch (error) {\n        console.error(`Processing failed for document ${documentId}:`, error);\n        throw error;\n    }\n}\n/**\n * Estimate processing time based on file size\n */ function estimateProcessingTime(fileSize) {\n    // Rough estimate: ~0.5 seconds per MB (faster with pure JS)\n    const seconds = Math.ceil(fileSize / (1024 * 1024 * 2));\n    return Math.max(seconds, 3) // Minimum 3 seconds\n    ;\n}\n/**\n * Get PDF page count without full processing\n */ async function getPdfPageCount(pdfUrl) {\n    try {\n        const response = await fetch(pdfUrl);\n        const pdfBytes = await response.arrayBuffer();\n        const pdfDoc = await pdf_lib__WEBPACK_IMPORTED_MODULE_0__.PDFDocument.load(pdfBytes);\n        return pdfDoc.getPageCount();\n    } catch (error) {\n        console.error(\"Failed to get page count:\", error);\n        return 0;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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SyxXQUFXLE1BQU1DLE1BQU1OO1FBQzdCLE1BQU1PLFdBQVcsTUFBTUYsU0FBU0csV0FBVztRQUMzQyxNQUFNQyxTQUFTLE1BQU1oQixnREFBV0EsQ0FBQ2lCLElBQUksQ0FBQ0g7UUFDdEMsT0FBT0UsT0FBT0csWUFBWTtJQUM1QixFQUFFLE9BQU84QixPQUFPO1FBQ2Q1QixRQUFRNEIsS0FBSyxDQUFDLDZCQUE2QkE7UUFDM0MsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wb3J0Zm9saW8tYXBwLy4vbGliL2ZsaXBib29rL3Byb2Nlc3Nvci50cz9mNmE0Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogUERGIFByb2Nlc3NpbmcgZm9yIEZsaXBib29rIHN5c3RlbVxuICogQ29udmVydHMgUERGIHBhZ2VzIHRvIGltYWdlcyB1c2luZyBwdXJlIEphdmFTY3JpcHQgKG5vIG5hdGl2ZSBkZXBlbmRlbmNpZXMpXG4gKlxuICogVXNlcyBwZGYtbGliIGZvciBQREYgbWFuaXB1bGF0aW9uIC0gd29ya3Mgb24gVmVyY2VsIHNlcnZlcmxlc3MgZnVuY3Rpb25zXG4gKi9cblxuaW1wb3J0IHsgUERGRG9jdW1lbnQgfSBmcm9tICdwZGYtbGliJ1xuaW1wb3J0IHsgdXBsb2FkUGFnZUltYWdlLCB1cGxvYWRUaHVtYm5haWwgfSBmcm9tICcuL3N0b3JhZ2Utc3VwYWJhc2UnXG5pbXBvcnQgeyB1cGRhdGVEb2N1bWVudFByb2dyZXNzLCBpbnNlcnRQYWdlcywgcHVibGlzaERvY3VtZW50IH0gZnJvbSAnLi9kYidcblxuaW50ZXJmYWNlIFBhZ2VEYXRhIHtcbiAgcGFnZV9udW1iZXI6IG51bWJlclxuICBpbWFnZV91cmw6IHN0cmluZ1xuICB3aWR0aDogbnVtYmVyXG4gIGhlaWdodDogbnVtYmVyXG59XG5cbmludGVyZmFjZSBQcm9jZXNzaW5nT3B0aW9ucyB7XG4gIHF1YWxpdHk/OiBudW1iZXIgLy8gSlBFRyBxdWFsaXR5IChkZWZhdWx0OiA4NSlcbiAgbWF4V2lkdGg/OiBudW1iZXIgLy8gTWF4IHdpZHRoIGluIHBpeGVscyAoZGVmYXVsdDogMTYwMClcbn1cblxuLyoqXG4gKiBQcm9jZXNzIGEgUERGIGZpbGUgYW5kIGNvbnZlcnQgcGFnZXMgdG8gaW1hZ2VzXG4gKiBOb3RlOiBUaGlzIGNvbnZlcnRzIFBERiBwYWdlcyB0byBQTkcgdXNpbmcgcGRmLWxpYidzIGJ1aWx0LWluIHJlbmRlcmluZ1xuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gcHJvY2Vzc1BkZlRvSW1hZ2VzKFxuICBwZGZVcmw6IHN0cmluZyxcbiAgZG9jdW1lbnRJZDogc3RyaW5nLFxuICBvcHRpb25zOiBQcm9jZXNzaW5nT3B0aW9ucyA9IHt9XG4pOiBQcm9taXNlPFBhZ2VEYXRhW10+IHtcbiAgY29uc3QgeyBxdWFsaXR5ID0gODUsIG1heFdpZHRoID0gMTYwMCB9ID0gb3B0aW9uc1xuXG4gIHRyeSB7XG4gICAgLy8gRmV0Y2ggdGhlIFBERlxuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2gocGRmVXJsKVxuICAgIGNvbnN0IHBkZkJ5dGVzID0gYXdhaXQgcmVzcG9uc2UuYXJyYXlCdWZmZXIoKVxuXG4gICAgLy8gTG9hZCBQREYgZG9jdW1lbnRcbiAgICBjb25zdCBwZGZEb2MgPSBhd2FpdCBQREZEb2N1bWVudC5sb2FkKHBkZkJ5dGVzKVxuICAgIGNvbnN0IHRvdGFsUGFnZXMgPSBwZGZEb2MuZ2V0UGFnZUNvdW50KClcbiAgICBjb25zdCBwYWdlczogUGFnZURhdGFbXSA9IFtdXG5cbiAgICBjb25zb2xlLmxvZyhgUHJvY2Vzc2luZyAke3RvdGFsUGFnZXN9IHBhZ2VzIGZyb20gUERGYClcblxuICAgIC8vIFByb2Nlc3MgZWFjaCBwYWdlXG4gICAgZm9yIChsZXQgcGFnZUluZGV4ID0gMDsgcGFnZUluZGV4IDwgdG90YWxQYWdlczsgcGFnZUluZGV4KyspIHtcbiAgICAgIGNvbnN0IHBhZ2VOdW0gPSBwYWdlSW5kZXggKyAxXG5cbiAgICAgIC8vIENyZWF0ZSBhIG5ldyBQREYgd2l0aCBqdXN0IHRoaXMgcGFnZVxuICAgICAgY29uc3Qgc2luZ2xlUGFnZVBkZiA9IGF3YWl0IFBERkRvY3VtZW50LmNyZWF0ZSgpXG4gICAgICBjb25zdCBbY29waWVkUGFnZV0gPSBhd2FpdCBzaW5nbGVQYWdlUGRmLmNvcHlQYWdlcyhwZGZEb2MsIFtwYWdlSW5kZXhdKVxuICAgICAgc2luZ2xlUGFnZVBkZi5hZGRQYWdlKGNvcGllZFBhZ2UpXG5cbiAgICAgIC8vIEdldCBwYWdlIGRpbWVuc2lvbnNcbiAgICAgIGNvbnN0IHBhZ2UgPSBwZGZEb2MuZ2V0UGFnZShwYWdlSW5kZXgpXG4gICAgICBsZXQgeyB3aWR0aCwgaGVpZ2h0IH0gPSBwYWdlLmdldFNpemUoKVxuXG4gICAgICAvLyBTY2FsZSBkb3duIGlmIHRvbyB3aWRlXG4gICAgICBpZiAod2lkdGggPiBtYXhXaWR0aCkge1xuICAgICAgICBjb25zdCBzY2FsZSA9IG1heFdpZHRoIC8gd2lkdGhcbiAgICAgICAgd2lkdGggPSBtYXhXaWR0aFxuICAgICAgICBoZWlnaHQgPSBoZWlnaHQgKiBzY2FsZVxuICAgICAgfVxuXG4gICAgICAvLyBTYXZlIGFzIFBERiBieXRlcyAod2UnbGwgY29udmVydCB0byBpbWFnZSBvbiB0aGUgY2xpZW50IHNpZGUgZm9yIGRpc3BsYXkpXG4gICAgICBjb25zdCBwZGZQYWdlQnl0ZXMgPSBhd2FpdCBzaW5nbGVQYWdlUGRmLnNhdmUoKVxuICAgICAgY29uc3QgYnVmZmVyID0gQnVmZmVyLmZyb20ocGRmUGFnZUJ5dGVzKVxuXG4gICAgICAvLyBVcGxvYWQgdG8gc3RvcmFnZVxuICAgICAgY29uc3QgeyB1cmwgfSA9IGF3YWl0IHVwbG9hZFBhZ2VJbWFnZShidWZmZXIsIGRvY3VtZW50SWQsIHBhZ2VOdW0pXG5cbiAgICAgIHBhZ2VzLnB1c2goe1xuICAgICAgICBwYWdlX251bWJlcjogcGFnZU51bSxcbiAgICAgICAgaW1hZ2VfdXJsOiB1cmwsXG4gICAgICAgIHdpZHRoOiBNYXRoLnJvdW5kKHdpZHRoKSxcbiAgICAgICAgaGVpZ2h0OiBNYXRoLnJvdW5kKGhlaWdodCksXG4gICAgICB9KVxuXG4gICAgICAvLyBVcGRhdGUgcHJvZ3Jlc3NcbiAgICAgIGNvbnN0IHByb2dyZXNzID0gTWF0aC5mbG9vcigocGFnZU51bSAvIHRvdGFsUGFnZXMpICogOTApIC8vIFJlc2VydmUgMTAlIGZvciBmaW5hbGl6YXRpb25cbiAgICAgIGF3YWl0IHVwZGF0ZURvY3VtZW50UHJvZ3Jlc3MoZG9jdW1lbnRJZCwgcHJvZ3Jlc3MpXG5cbiAgICAgIGNvbnNvbGUubG9nKGBQcm9jZXNzZWQgcGFnZSAke3BhZ2VOdW19LyR7dG90YWxQYWdlc31gKVxuICAgIH1cblxuICAgIHJldHVybiBwYWdlc1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1BERiBwcm9jZXNzaW5nIGVycm9yOicsIGVycm9yKVxuICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHByb2Nlc3MgUERGOiAke2Vycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ1Vua25vd24gZXJyb3InfWApXG4gIH1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSB0aHVtYm5haWwgZnJvbSBmaXJzdCBwYWdlXG4gKiBGb3Igbm93LCB3ZSdsbCB1c2UgdGhlIGZpcnN0IHBhZ2UgUERGIGFzIHRoZSB0aHVtYm5haWxcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlVGh1bWJuYWlsKFxuICBmaXJzdFBhZ2VVcmw6IHN0cmluZyxcbiAgZG9jdW1lbnRJZDogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICB0cnkge1xuICAgIC8vIEZldGNoIGZpcnN0IHBhZ2VcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGZpcnN0UGFnZVVybClcbiAgICBjb25zdCBidWZmZXIgPSBCdWZmZXIuZnJvbShhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpKVxuXG4gICAgLy8gRm9yIG5vdywganVzdCB1c2UgdGhlIGZpcnN0IHBhZ2UgUERGIGFzIHRodW1ibmFpbFxuICAgIC8vIFRoZSBjbGllbnQgd2lsbCByZW5kZXIgaXQgYXQgdGh1bWJuYWlsIHNpemVcbiAgICBjb25zdCB0aHVtYm5haWxVcmwgPSBhd2FpdCB1cGxvYWRUaHVtYm5haWwoYnVmZmVyLCBkb2N1bWVudElkKVxuXG4gICAgcmV0dXJuIHRodW1ibmFpbFVybFxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ1RodW1ibmFpbCBnZW5lcmF0aW9uIGVycm9yOicsIGVycm9yKVxuICAgIHRocm93IG5ldyBFcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIHRodW1ibmFpbCcpXG4gIH1cbn1cblxuLyoqXG4gKiBDb21wbGV0ZSBlbmQtdG8tZW5kIHByb2Nlc3NpbmcgcGlwZWxpbmVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHByb2Nlc3NEb2N1bWVudChcbiAgcGRmVXJsOiBzdHJpbmcsXG4gIGRvY3VtZW50SWQ6IHN0cmluZyxcbiAgb3B0aW9ucz86IFByb2Nlc3NpbmdPcHRpb25zXG4pOiBQcm9taXNlPHZvaWQ+IHtcbiAgdHJ5IHtcbiAgICAvLyBTdGVwIDE6IENvbnZlcnQgUERGIHRvIHBhZ2UgUERGc1xuICAgIGNvbnNvbGUubG9nKGBTdGFydGluZyBwcm9jZXNzaW5nIGZvciBkb2N1bWVudCAke2RvY3VtZW50SWR9YClcbiAgICBjb25zdCBwYWdlcyA9IGF3YWl0IHByb2Nlc3NQZGZUb0ltYWdlcyhwZGZVcmwsIGRvY3VtZW50SWQsIG9wdGlvbnMpXG5cbiAgICAvLyBTdGVwIDI6IEluc2VydCBwYWdlIHJlY29yZHMgaW50byBkYXRhYmFzZVxuICAgIGF3YWl0IGluc2VydFBhZ2VzKGRvY3VtZW50SWQsIHBhZ2VzKVxuICAgIGF3YWl0IHVwZGF0ZURvY3VtZW50UHJvZ3Jlc3MoZG9jdW1lbnRJZCwgOTUpXG5cbiAgICAvLyBTdGVwIDM6IEdlbmVyYXRlIHRodW1ibmFpbFxuICAgIGNvbnN0IHRodW1ibmFpbFVybCA9IGF3YWl0IGdlbmVyYXRlVGh1bWJuYWlsKHBhZ2VzWzBdLmltYWdlX3VybCwgZG9jdW1lbnRJZClcbiAgICBhd2FpdCB1cGRhdGVEb2N1bWVudFByb2dyZXNzKGRvY3VtZW50SWQsIDk4KVxuXG4gICAgLy8gU3RlcCA0OiBNYXJrIGFzIHB1Ymxpc2hlZFxuICAgIGF3YWl0IHB1Ymxpc2hEb2N1bWVudChkb2N1bWVudElkLCBwYWdlcy5sZW5ndGgsIHRodW1ibmFpbFVybClcblxuICAgIGNvbnNvbGUubG9nKGBTdWNjZXNzZnVsbHkgcHJvY2Vzc2VkIGRvY3VtZW50ICR7ZG9jdW1lbnRJZH0gd2l0aCAke3BhZ2VzLmxlbmd0aH0gcGFnZXNgKVxuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoYFByb2Nlc3NpbmcgZmFpbGVkIGZvciBkb2N1bWVudCAke2RvY3VtZW50SWR9OmAsIGVycm9yKVxuICAgIHRocm93IGVycm9yXG4gIH1cbn1cblxuLyoqXG4gKiBFc3RpbWF0ZSBwcm9jZXNzaW5nIHRpbWUgYmFzZWQgb24gZmlsZSBzaXplXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBlc3RpbWF0ZVByb2Nlc3NpbmdUaW1lKGZpbGVTaXplOiBudW1iZXIpOiBudW1iZXIge1xuICAvLyBSb3VnaCBlc3RpbWF0ZTogfjAuNSBzZWNvbmRzIHBlciBNQiAoZmFzdGVyIHdpdGggcHVyZSBKUylcbiAgY29uc3Qgc2Vjb25kcyA9IE1hdGguY2VpbChmaWxlU2l6ZSAvICgxMDI0ICogMTAyNCAqIDIpKVxuICByZXR1cm4gTWF0aC5tYXgoc2Vjb25kcywgMykgLy8gTWluaW11bSAzIHNlY29uZHNcbn1cblxuLyoqXG4gKiBHZXQgUERGIHBhZ2UgY291bnQgd2l0aG91dCBmdWxsIHByb2Nlc3NpbmdcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFBkZlBhZ2VDb3VudChwZGZVcmw6IHN0cmluZyk6IFByb21pc2U8bnVtYmVyPiB7XG4gIHRyeSB7XG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaChwZGZVcmwpXG4gICAgY29uc3QgcGRmQnl0ZXMgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpXG4gICAgY29uc3QgcGRmRG9jID0gYXdhaXQgUERGRG9jdW1lbnQubG9hZChwZGZCeXRlcylcbiAgICByZXR1cm4gcGRmRG9jLmdldFBhZ2VDb3VudCgpXG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcignRmFpbGVkIHRvIGdldCBwYWdlIGNvdW50OicsIGVycm9yKVxuICAgIHJldHVybiAwXG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJQREZEb2N1bWVudCIsInVwbG9hZFBhZ2VJbWFnZSIsInVwbG9hZFRodW1ibmFpbCIsInVwZGF0ZURvY3VtZW50UHJvZ3Jlc3MiLCJpbnNlcnRQYWdlcyIsInB1Ymxpc2hEb2N1bWVudCIsInByb2Nlc3NQZGZUb0ltYWdlcyIsInBkZlVybCIsImRvY3VtZW50SWQiLCJvcHRpb25zIiwicXVhbGl0eSIsIm1heFdpZHRoIiwicmVzcG9uc2UiLCJmZXRjaCIsInBkZkJ5dGVzIiwiYXJyYXlCdWZmZXIiLCJwZGZEb2MiLCJsb2FkIiwidG90YWxQYWdlcyIsImdldFBhZ2VDb3VudCIsInBhZ2VzIiwiY29uc29sZSIsImxvZyIsInBhZ2VJbmRleCIsInBhZ2VOdW0iLCJzaW5nbGVQYWdlUGRmIiwiY3JlYXRlIiwiY29waWVkUGFnZSIsImNvcHlQYWdlcyIsImFkZFBhZ2UiLCJwYWdlIiwiZ2V0UGFnZSIsIndpZHRoIiwiaGVpZ2h0IiwiZ2V0U2l6ZSIsInNjYWxlIiwicGRmUGFnZUJ5dGVzIiwic2F2ZSIsImJ1ZmZlciIsIkJ1ZmZlciIsImZyb20iLCJ1cmwiLCJwdXNoIiwicGFnZV9udW1iZXIiLCJpbWFnZV91cmwiLCJNYXRoIiwicm91bmQiLCJwcm9ncmVzcyIsImZsb29yIiwiZXJyb3IiLCJFcnJvciIsIm1lc3NhZ2UiLCJnZW5lcmF0ZVRodW1ibmFpbCIsImZpcnN0UGFnZVVybCIsInRodW1ibmFpbFVybCIsInByb2Nlc3NEb2N1bWVudCIsImxlbmd0aCIsImVzdGltYXRlUHJvY2Vzc2luZ1RpbWUiLCJmaWxlU2l6ZSIsInNlY29uZHMiLCJjZWlsIiwibWF4IiwiZ2V0UGRmUGFnZUNvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./lib/flipbook/processor.ts\n");

/***/ }),

/***/ "(rsc)/./lib/flipbook/storage-supabase.ts":
/*!******************************************!*\
  !*** ./lib/flipbook/storage-supabase.ts ***!
  \******************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   deleteDocumentFiles: () => (/* binding */ deleteDocumentFiles),\n/* harmony export */   deleteFile: () => (/* binding */ deleteFile),\n/* harmony export */   getDocumentStorageSize: () => (/* binding */ getDocumentStorageSize),\n/* harmony export */   sanitizeFilename: () => (/* binding */ sanitizeFilename),\n/* harmony export */   uploadOriginalPdf: () => (/* binding */ uploadOriginalPdf),\n/* harmony export */   uploadPageImage: () => (/* binding */ uploadPageImage),\n/* harmony export */   uploadThumbnail: () => (/* binding */ uploadThumbnail),\n/* harmony export */   validatePdfFile: () => (/* binding */ validatePdfFile)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"(rsc)/./node_modules/@supabase/supabase-js/dist/module/index.js\");\n/**\n * Supabase Storage adapter for flipbook system\n * Uses Supabase Storage buckets for file hosting\n */ \nconst supabaseUrl = \"https://xdzaqafffixglhjfwqsy.supabase.co\";\nconst supabaseServiceKey = process.env.SUPABASE_SERVICE_ROLE_KEY;\nconst supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(supabaseUrl, supabaseServiceKey);\nconst BUCKET_NAME = \"flipbooks\";\n/**\n * Ensure bucket exists\n */ async function ensureBucket() {\n    const { data: buckets } = await supabase.storage.listBuckets();\n    if (!buckets?.find((b)=>b.name === BUCKET_NAME)) {\n        await supabase.storage.createBucket(BUCKET_NAME, {\n            public: true,\n            fileSizeLimit: 52428800\n        });\n    }\n}\n/**\n * Upload original PDF file\n */ async function uploadOriginalPdf(file, filename) {\n    await ensureBucket();\n    // Add random suffix to filename\n    const randomSuffix = Math.random().toString(36).substring(2, 8);\n    const filenameWithSuffix = filename.replace(/(\\.[^.]+)$/, `-${randomSuffix}$1`);\n    const path = `originals/${filenameWithSuffix}`;\n    // Convert File to ArrayBuffer if needed\n    let fileData;\n    if (file instanceof Buffer) {\n        fileData = file;\n    } else {\n        // File object from browser/FormData\n        fileData = await file.arrayBuffer();\n    }\n    const { data, error } = await supabase.storage.from(BUCKET_NAME).upload(path, fileData, {\n        contentType: \"application/pdf\",\n        upsert: false\n    });\n    if (error) {\n        throw new Error(`Failed to upload PDF: ${error.message}`);\n    }\n    // Get public URL\n    const { data: { publicUrl } } = supabase.storage.from(BUCKET_NAME).getPublicUrl(path);\n    return publicUrl;\n}\n/**\n * Upload processed page image\n */ async function uploadPageImage(imageBuffer, documentId, pageNumber) {\n    await ensureBucket();\n    const filename = `page-${pageNumber.toString().padStart(4, \"0\")}.webp`;\n    const path = `${documentId}/${filename}`;\n    const { data, error } = await supabase.storage.from(BUCKET_NAME).upload(path, imageBuffer, {\n        contentType: \"image/webp\",\n        upsert: false\n    });\n    if (error) {\n        throw new Error(`Failed to upload page image: ${error.message}`);\n    }\n    const { data: { publicUrl } } = supabase.storage.from(BUCKET_NAME).getPublicUrl(path);\n    return {\n        url: publicUrl,\n        size: imageBuffer.length\n    };\n}\n/**\n * Upload thumbnail image\n */ async function uploadThumbnail(imageBuffer, documentId) {\n    await ensureBucket();\n    const path = `${documentId}/thumbnail.webp`;\n    const { data, error } = await supabase.storage.from(BUCKET_NAME).upload(path, imageBuffer, {\n        contentType: \"image/webp\",\n        upsert: true\n    });\n    if (error) {\n        throw new Error(`Failed to upload thumbnail: ${error.message}`);\n    }\n    const { data: { publicUrl } } = supabase.storage.from(BUCKET_NAME).getPublicUrl(path);\n    return publicUrl;\n}\n/**\n * Delete all files for a document\n */ async function deleteDocumentFiles(documentId) {\n    const { data: files } = await supabase.storage.from(BUCKET_NAME).list(documentId);\n    if (files && files.length > 0) {\n        const filePaths = files.map((file)=>`${documentId}/${file.name}`);\n        await supabase.storage.from(BUCKET_NAME).remove(filePaths);\n    }\n}\n/**\n * Delete a single file by URL\n */ async function deleteFile(url) {\n    // Extract path from public URL\n    const urlObj = new URL(url);\n    const pathMatch = urlObj.pathname.match(/\\/storage\\/v1\\/object\\/public\\/flipbooks\\/(.+)/);\n    if (pathMatch) {\n        const path = pathMatch[1];\n        await supabase.storage.from(BUCKET_NAME).remove([\n            path\n        ]);\n    }\n}\n/**\n * Get storage stats for a document\n */ async function getDocumentStorageSize(documentId) {\n    const { data: files } = await supabase.storage.from(BUCKET_NAME).list(documentId);\n    if (!files) return 0;\n    // Note: Supabase doesn't return file sizes in list, so we return count instead\n    return files.length;\n}\n/**\n * Validate file is a PDF\n */ function validatePdfFile(file) {\n    const validTypes = [\n        \"application/pdf\"\n    ];\n    const maxSize = 50 * 1024 * 1024 // 50MB\n    ;\n    if (!validTypes.includes(file.type)) {\n        return {\n            valid: false,\n            error: \"File must be a PDF document\"\n        };\n    }\n    if (file.size > maxSize) {\n        return {\n            valid: false,\n            error: \"File size must be less than 50MB\"\n        };\n    }\n    return {\n        valid: true\n    };\n}\n/**\n * Generate a safe filename\n */ function sanitizeFilename(filename) {\n    return filename.replace(/[^a-zA-Z0-9.-]/g, \"_\").replace(/_{2,}/g, \"_\").toLowerCase();\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUNiLE1BQU0vQixPQUFPK0IsU0FBUyxDQUFDLEVBQUU7UUFDekIsTUFBTXRELFNBQVNLLE9BQU8sQ0FDbkJ1QixJQUFJLENBQUMzQixhQUNMaUQsTUFBTSxDQUFDO1lBQUMzQjtTQUFLO0lBQ2xCO0FBQ0Y7QUFFQTs7Q0FFQyxHQUNNLGVBQWVrQyx1QkFBdUJuQixVQUFrQjtJQUM3RCxNQUFNLEVBQUVuQyxNQUFNMkMsS0FBSyxFQUFFLEdBQUcsTUFBTTlDLFNBQVNLLE9BQU8sQ0FDM0N1QixJQUFJLENBQUMzQixhQUNMOEMsSUFBSSxDQUFDVDtJQUVSLElBQUksQ0FBQ1EsT0FBTyxPQUFPO0lBRW5CLCtFQUErRTtJQUMvRSxPQUFPQSxNQUFNSCxNQUFNO0FBQ3JCO0FBRUE7O0NBRUMsR0FDTSxTQUFTZSxnQkFBZ0I1QyxJQUFVO0lBQ3hDLE1BQU02QyxhQUFhO1FBQUM7S0FBa0I7SUFDdEMsTUFBTUMsVUFBVSxLQUFLLE9BQU8sS0FBSyxPQUFPOztJQUV4QyxJQUFJLENBQUNELFdBQVdFLFFBQVEsQ0FBQy9DLEtBQUtnRCxJQUFJLEdBQUc7UUFDbkMsT0FBTztZQUNMQyxPQUFPO1lBQ1BwQyxPQUFPO1FBQ1Q7SUFDRjtJQUVBLElBQUliLEtBQUs0QixJQUFJLEdBQUdrQixTQUFTO1FBQ3ZCLE9BQU87WUFDTEcsT0FBTztZQUNQcEMsT0FBTztRQUNUO0lBQ0Y7SUFFQSxPQUFPO1FBQUVvQyxPQUFPO0lBQUs7QUFDdkI7QUFFQTs7Q0FFQyxHQUNNLFNBQVNDLGlCQUFpQmpELFFBQWdCO0lBQy9DLE9BQU9BLFNBQ0pPLE9BQU8sQ0FBQyxtQkFBbUIsS0FDM0JBLE9BQU8sQ0FBQyxVQUFVLEtBQ2xCMkMsV0FBVztBQUNoQiIsInNvdXJjZXMiOlsid2VicGFjazovL3BvcnRmb2xpby1hcHAvLi9saWIvZmxpcGJvb2svc3RvcmFnZS1zdXBhYmFzZS50cz81MDgyIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogU3VwYWJhc2UgU3RvcmFnZSBhZGFwdGVyIGZvciBmbGlwYm9vayBzeXN0ZW1cbiAqIFVzZXMgU3VwYWJhc2UgU3RvcmFnZSBidWNrZXRzIGZvciBmaWxlIGhvc3RpbmdcbiAqL1xuXG5pbXBvcnQgeyBjcmVhdGVDbGllbnQgfSBmcm9tICdAc3VwYWJhc2Uvc3VwYWJhc2UtanMnXG5cbmNvbnN0IHN1cGFiYXNlVXJsID0gcHJvY2Vzcy5lbnYuTkVYVF9QVUJMSUNfU1VQQUJBU0VfVVJMIVxuY29uc3Qgc3VwYWJhc2VTZXJ2aWNlS2V5ID0gcHJvY2Vzcy5lbnYuU1VQQUJBU0VfU0VSVklDRV9ST0xFX0tFWSFcblxuY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoc3VwYWJhc2VVcmwsIHN1cGFiYXNlU2VydmljZUtleSlcblxuY29uc3QgQlVDS0VUX05BTUUgPSAnZmxpcGJvb2tzJ1xuXG4vKipcbiAqIEVuc3VyZSBidWNrZXQgZXhpc3RzXG4gKi9cbmFzeW5jIGZ1bmN0aW9uIGVuc3VyZUJ1Y2tldCgpIHtcbiAgY29uc3QgeyBkYXRhOiBidWNrZXRzIH0gPSBhd2FpdCBzdXBhYmFzZS5zdG9yYWdlLmxpc3RCdWNrZXRzKClcblxuICBpZiAoIWJ1Y2tldHM/LmZpbmQoYiA9PiBiLm5hbWUgPT09IEJVQ0tFVF9OQU1FKSkge1xuICAgIGF3YWl0IHN1cGFiYXNlLnN0b3JhZ2UuY3JlYXRlQnVja2V0KEJVQ0tFVF9OQU1FLCB7XG4gICAgICBwdWJsaWM6IHRydWUsXG4gICAgICBmaWxlU2l6ZUxpbWl0OiA1MjQyODgwMCwgLy8gNTBNQlxuICAgIH0pXG4gIH1cbn1cblxuLyoqXG4gKiBVcGxvYWQgb3JpZ2luYWwgUERGIGZpbGVcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZE9yaWdpbmFsUGRmKFxuICBmaWxlOiBGaWxlIHwgQnVmZmVyLFxuICBmaWxlbmFtZTogc3RyaW5nXG4pOiBQcm9taXNlPHN0cmluZz4ge1xuICBhd2FpdCBlbnN1cmVCdWNrZXQoKVxuXG4gIC8vIEFkZCByYW5kb20gc3VmZml4IHRvIGZpbGVuYW1lXG4gIGNvbnN0IHJhbmRvbVN1ZmZpeCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnN1YnN0cmluZygyLCA4KVxuICBjb25zdCBmaWxlbmFtZVdpdGhTdWZmaXggPSBmaWxlbmFtZS5yZXBsYWNlKC8oXFwuW14uXSspJC8sIGAtJHtyYW5kb21TdWZmaXh9JDFgKVxuICBjb25zdCBwYXRoID0gYG9yaWdpbmFscy8ke2ZpbGVuYW1lV2l0aFN1ZmZpeH1gXG5cbiAgLy8gQ29udmVydCBGaWxlIHRvIEFycmF5QnVmZmVyIGlmIG5lZWRlZFxuICBsZXQgZmlsZURhdGE6IEFycmF5QnVmZmVyIHwgQnVmZmVyXG4gIGlmIChmaWxlIGluc3RhbmNlb2YgQnVmZmVyKSB7XG4gICAgZmlsZURhdGEgPSBmaWxlXG4gIH0gZWxzZSB7XG4gICAgLy8gRmlsZSBvYmplY3QgZnJvbSBicm93c2VyL0Zvcm1EYXRhXG4gICAgZmlsZURhdGEgPSBhd2FpdCAoZmlsZSBhcyBGaWxlKS5hcnJheUJ1ZmZlcigpXG4gIH1cblxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5zdG9yYWdlXG4gICAgLmZyb20oQlVDS0VUX05BTUUpXG4gICAgLnVwbG9hZChwYXRoLCBmaWxlRGF0YSwge1xuICAgICAgY29udGVudFR5cGU6ICdhcHBsaWNhdGlvbi9wZGYnLFxuICAgICAgdXBzZXJ0OiBmYWxzZSxcbiAgICB9KVxuXG4gIGlmIChlcnJvcikge1xuICAgIHRocm93IG5ldyBFcnJvcihgRmFpbGVkIHRvIHVwbG9hZCBQREY6ICR7ZXJyb3IubWVzc2FnZX1gKVxuICB9XG5cbiAgLy8gR2V0IHB1YmxpYyBVUkxcbiAgY29uc3QgeyBkYXRhOiB7IHB1YmxpY1VybCB9IH0gPSBzdXBhYmFzZS5zdG9yYWdlXG4gICAgLmZyb20oQlVDS0VUX05BTUUpXG4gICAgLmdldFB1YmxpY1VybChwYXRoKVxuXG4gIHJldHVybiBwdWJsaWNVcmxcbn1cblxuLyoqXG4gKiBVcGxvYWQgcHJvY2Vzc2VkIHBhZ2UgaW1hZ2VcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHVwbG9hZFBhZ2VJbWFnZShcbiAgaW1hZ2VCdWZmZXI6IEJ1ZmZlcixcbiAgZG9jdW1lbnRJZDogc3RyaW5nLFxuICBwYWdlTnVtYmVyOiBudW1iZXJcbik6IFByb21pc2U8eyB1cmw6IHN0cmluZzsgc2l6ZTogbnVtYmVyIH0+IHtcbiAgYXdhaXQgZW5zdXJlQnVja2V0KClcblxuICBjb25zdCBmaWxlbmFtZSA9IGBwYWdlLSR7cGFnZU51bWJlci50b1N0cmluZygpLnBhZFN0YXJ0KDQsICcwJyl9LndlYnBgXG4gIGNvbnN0IHBhdGggPSBgJHtkb2N1bWVudElkfS8ke2ZpbGVuYW1lfWBcblxuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBzdXBhYmFzZS5zdG9yYWdlXG4gICAgLmZyb20oQlVDS0VUX05BTUUpXG4gICAgLnVwbG9hZChwYXRoLCBpbWFnZUJ1ZmZlciwge1xuICAgICAgY29udGVudFR5cGU6ICdpbWFnZS93ZWJwJyxcbiAgICAgIHVwc2VydDogZmFsc2UsXG4gICAgfSlcblxuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoYEZhaWxlZCB0byB1cGxvYWQgcGFnZSBpbWFnZTogJHtlcnJvci5tZXNzYWdlfWApXG4gIH1cblxuICBjb25zdCB7IGRhdGE6IHsgcHVibGljVXJsIH0gfSA9IHN1cGFiYXNlLnN0b3JhZ2VcbiAgICAuZnJvbShCVUNLRVRfTkFNRSlcbiAgICAuZ2V0UHVibGljVXJsKHBhdGgpXG5cbiAgcmV0dXJuIHtcbiAgICB1cmw6IHB1YmxpY1VybCxcbiAgICBzaXplOiBpbWFnZUJ1ZmZlci5sZW5ndGgsXG4gIH1cbn1cblxuLyoqXG4gKiBVcGxvYWQgdGh1bWJuYWlsIGltYWdlXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiB1cGxvYWRUaHVtYm5haWwoXG4gIGltYWdlQnVmZmVyOiBCdWZmZXIsXG4gIGRvY3VtZW50SWQ6IHN0cmluZ1xuKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgYXdhaXQgZW5zdXJlQnVja2V0KClcblxuICBjb25zdCBwYXRoID0gYCR7ZG9jdW1lbnRJZH0vdGh1bWJuYWlsLndlYnBgXG5cbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgc3VwYWJhc2Uuc3RvcmFnZVxuICAgIC5mcm9tKEJVQ0tFVF9OQU1FKVxuICAgIC51cGxvYWQocGF0aCwgaW1hZ2VCdWZmZXIsIHtcbiAgICAgIGNvbnRlbnRUeXBlOiAnaW1hZ2Uvd2VicCcsXG4gICAgICB1cHNlcnQ6IHRydWUsIC8vIEFsbG93IG92ZXJ3cml0ZSBmb3IgdGh1bWJuYWlsc1xuICAgIH0pXG5cbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gdXBsb2FkIHRodW1ibmFpbDogJHtlcnJvci5tZXNzYWdlfWApXG4gIH1cblxuICBjb25zdCB7IGRhdGE6IHsgcHVibGljVXJsIH0gfSA9IHN1cGFiYXNlLnN0b3JhZ2VcbiAgICAuZnJvbShCVUNLRVRfTkFNRSlcbiAgICAuZ2V0UHVibGljVXJsKHBhdGgpXG5cbiAgcmV0dXJuIHB1YmxpY1VybFxufVxuXG4vKipcbiAqIERlbGV0ZSBhbGwgZmlsZXMgZm9yIGEgZG9jdW1lbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGRlbGV0ZURvY3VtZW50RmlsZXMoZG9jdW1lbnRJZDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIGNvbnN0IHsgZGF0YTogZmlsZXMgfSA9IGF3YWl0IHN1cGFiYXNlLnN0b3JhZ2VcbiAgICAuZnJvbShCVUNLRVRfTkFNRSlcbiAgICAubGlzdChkb2N1bWVudElkKVxuXG4gIGlmIChmaWxlcyAmJiBmaWxlcy5sZW5ndGggPiAwKSB7XG4gICAgY29uc3QgZmlsZVBhdGhzID0gZmlsZXMubWFwKGZpbGUgPT4gYCR7ZG9jdW1lbnRJZH0vJHtmaWxlLm5hbWV9YClcbiAgICBhd2FpdCBzdXBhYmFzZS5zdG9yYWdlXG4gICAgICAuZnJvbShCVUNLRVRfTkFNRSlcbiAgICAgIC5yZW1vdmUoZmlsZVBhdGhzKVxuICB9XG59XG5cbi8qKlxuICogRGVsZXRlIGEgc2luZ2xlIGZpbGUgYnkgVVJMXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBkZWxldGVGaWxlKHVybDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIC8vIEV4dHJhY3QgcGF0aCBmcm9tIHB1YmxpYyBVUkxcbiAgY29uc3QgdXJsT2JqID0gbmV3IFVSTCh1cmwpXG4gIGNvbnN0IHBhdGhNYXRjaCA9IHVybE9iai5wYXRobmFtZS5tYXRjaCgvXFwvc3RvcmFnZVxcL3YxXFwvb2JqZWN0XFwvcHVibGljXFwvZmxpcGJvb2tzXFwvKC4rKS8pXG5cbiAgaWYgKHBhdGhNYXRjaCkge1xuICAgIGNvbnN0IHBhdGggPSBwYXRoTWF0Y2hbMV1cbiAgICBhd2FpdCBzdXBhYmFzZS5zdG9yYWdlXG4gICAgICAuZnJvbShCVUNLRVRfTkFNRSlcbiAgICAgIC5yZW1vdmUoW3BhdGhdKVxuICB9XG59XG5cbi8qKlxuICogR2V0IHN0b3JhZ2Ugc3RhdHMgZm9yIGEgZG9jdW1lbnRcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldERvY3VtZW50U3RvcmFnZVNpemUoZG9jdW1lbnRJZDogc3RyaW5nKTogUHJvbWlzZTxudW1iZXI+IHtcbiAgY29uc3QgeyBkYXRhOiBmaWxlcyB9ID0gYXdhaXQgc3VwYWJhc2Uuc3RvcmFnZVxuICAgIC5mcm9tKEJVQ0tFVF9OQU1FKVxuICAgIC5saXN0KGRvY3VtZW50SWQpXG5cbiAgaWYgKCFmaWxlcykgcmV0dXJuIDBcblxuICAvLyBOb3RlOiBTdXBhYmFzZSBkb2Vzbid0IHJldHVybiBmaWxlIHNpemVzIGluIGxpc3QsIHNvIHdlIHJldHVybiBjb3VudCBpbnN0ZWFkXG4gIHJldHVybiBmaWxlcy5sZW5ndGhcbn1cblxuLyoqXG4gKiBWYWxpZGF0ZSBmaWxlIGlzIGEgUERGXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZVBkZkZpbGUoZmlsZTogRmlsZSk6IHsgdmFsaWQ6IGJvb2xlYW47IGVycm9yPzogc3RyaW5nIH0ge1xuICBjb25zdCB2YWxpZFR5cGVzID0gWydhcHBsaWNhdGlvbi9wZGYnXVxuICBjb25zdCBtYXhTaXplID0gNTAgKiAxMDI0ICogMTAyNCAvLyA1ME1CXG5cbiAgaWYgKCF2YWxpZFR5cGVzLmluY2x1ZGVzKGZpbGUudHlwZSkpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdmFsaWQ6IGZhbHNlLFxuICAgICAgZXJyb3I6ICdGaWxlIG11c3QgYmUgYSBQREYgZG9jdW1lbnQnLFxuICAgIH1cbiAgfVxuXG4gIGlmIChmaWxlLnNpemUgPiBtYXhTaXplKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIHZhbGlkOiBmYWxzZSxcbiAgICAgIGVycm9yOiAnRmlsZSBzaXplIG11c3QgYmUgbGVzcyB0aGFuIDUwTUInLFxuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7IHZhbGlkOiB0cnVlIH1cbn1cblxuLyoqXG4gKiBHZW5lcmF0ZSBhIHNhZmUgZmlsZW5hbWVcbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHNhbml0aXplRmlsZW5hbWUoZmlsZW5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBmaWxlbmFtZVxuICAgIC5yZXBsYWNlKC9bXmEtekEtWjAtOS4tXS9nLCAnXycpXG4gICAgLnJlcGxhY2UoL197Mix9L2csICdfJylcbiAgICAudG9Mb3dlckNhc2UoKVxufVxuIl0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsInN1cGFiYXNlVXJsIiwicHJvY2VzcyIsImVudiIsIk5FWFRfUFVCTElDX1NVUEFCQVNFX1VSTCIsInN1cGFiYXNlU2VydmljZUtleSIsIlNVUEFCQVNFX1NFUlZJQ0VfUk9MRV9LRVkiLCJzdXBhYmFzZSIsIkJVQ0tFVF9OQU1FIiwiZW5zdXJlQnVja2V0IiwiZGF0YSIsImJ1Y2tldHMiLCJzdG9yYWdlIiwibGlzdEJ1Y2tldHMiLCJmaW5kIiwiYiIsIm5hbWUiLCJjcmVhdGVCdWNrZXQiLCJwdWJsaWMiLCJmaWxlU2l6ZUxpbWl0IiwidXBsb2FkT3JpZ2luYWxQZGYiLCJmaWxlIiwiZmlsZW5hbWUiLCJyYW5kb21TdWZmaXgiLCJNYXRoIiwicmFuZG9tIiwidG9TdHJpbmciLCJzdWJzdHJpbmciLCJmaWxlbmFtZVdpdGhTdWZmaXgiLCJyZXBsYWNlIiwicGF0aCIsImZpbGVEYXRhIiwiQnVmZmVyIiwiYXJyYXlCdWZmZXIiLCJlcnJvciIsImZyb20iLCJ1cGxvYWQiLCJjb250ZW50VHlwZSIsInVwc2VydCIsIkVycm9yIiwibWVzc2FnZSIsInB1YmxpY1VybCIsImdldFB1YmxpY1VybCIsInVwbG9hZFBhZ2VJbWFnZSIsImltYWdlQnVmZmVyIiwiZG9jdW1lbnRJZCIsInBhZ2VOdW1iZXIiLCJwYWRTdGFydCIsInVybCIsInNpemUiLCJsZW5ndGgiLCJ1cGxvYWRUaHVtYm5haWwiLCJkZWxldGVEb2N1bWVudEZpbGVzIiwiZmlsZXMiLCJsaXN0IiwiZmlsZVBhdGhzIiwibWFwIiwicmVtb3ZlIiwiZGVsZXRlRmlsZSIsInVybE9iaiIsIlVSTCIsInBhdGhNYXRjaCIsInBhdGhuYW1lIiwibWF0Y2giLCJnZXREb2N1bWVudFN0b3JhZ2VTaXplIiwidmFsaWRhdGVQZGZGaWxlIiwidmFsaWRUeXBlcyIsIm1heFNpemUiLCJpbmNsdWRlcyIsInR5cGUiLCJ2YWxpZCIsInNhbml0aXplRmlsZW5hbWUiLCJ0b0xvd2VyQ2FzZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./lib/flipbook/storage-supabase.ts\n");

/***/ })

};
;